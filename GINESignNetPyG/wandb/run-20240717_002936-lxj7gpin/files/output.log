BN? True
BN? True
BN? True
BN? True
BN? True
BN? True
BN? True
BN? True
BN? True
BN? True
BN? True
BN? True
batchnorm BN
hidden 6
BN? True
> /lfs/hyperturing1/0/echoi1/Random-SignNet/GINESignNetPyG/core/model_utils/pyg_gnn_wrapper.py(162)forward()
-> LX = torch.einsum('bij,bjfn->bifn', laplacian_batch, x_padded)
/lfs/hyperturing1/0/echoi1/Random-SignNet/GINESignNetPyG/core/model.py:102: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3675.)
  rand_out = F.linear(x_r.T.reshape(N*M, -1), self.weight[:, -1:], self.bias) #N*MxF
157  	        for i, num_nodes in enumerate(num_nodes_per_graph):
158  	            x_padded[i, :num_nodes] = x[offset:offset + num_nodes]
159  	            offset += num_nodes
160  	        import pdb; pdb.set_trace()
161  	        # Perform batch matrix multiplication for each sample
162  ->	        LX = torch.einsum('bij,bjfn->bifn', laplacian_batch, x_padded)
163  	
164  	        # Flatten back to (num_nodes * batch_size, num_features, num_samples)
165  	        LX = LX.view(-1, LX.size(-2), LX.size(-1))
166  	        import pdb; pdb.set_trace()
167  	
tensor([[[[-5.4225e-01, -6.6796e-01, -6.3153e-01,  ..., -6.2771e-01,
           -5.3616e-01, -6.8639e-01],
          [-1.4337e+00, -1.5234e+00, -1.4800e+00,  ..., -1.3754e+00,
           -1.4473e+00, -1.5075e+00],
          [-1.3321e-02,  5.5220e-02, -4.4177e-02,  ...,  1.1708e-01,
            8.2551e-02,  5.6587e-02],
          ...,
          [-4.1156e-03,  6.9135e-02,  1.1800e-01,  ...,  8.6007e-02,
           -1.0607e-01, -2.7707e-02],
          [ 1.0701e-01,  9.8492e-02,  2.1890e-01,  ...,  5.1115e-02,
            9.2773e-02,  5.9631e-02],
          [ 9.3589e-01,  1.1473e+00,  9.7651e-01,  ...,  1.1190e+00,
            1.2469e+00,  1.0846e+00]],
         [[-7.7242e-01, -8.8783e-01, -8.4682e-01,  ..., -8.3434e-01,
           -7.6168e-01, -8.9709e-01],
          [-5.4308e-01, -6.3571e-01, -5.9315e-01,  ..., -5.0298e-01,
           -5.0970e-01, -5.5048e-01],
          [ 7.1291e-01,  7.8365e-01,  7.5353e-01,  ...,  8.2372e-01,
            8.5421e-01,  7.6890e-01],
          ...,
          [-2.3555e-01, -1.3874e-01, -1.1426e-01,  ..., -1.0466e-01,
           -3.1963e-01, -2.3417e-01],
          [-4.4859e-01, -4.6251e-01, -3.3577e-01,  ..., -4.7447e-01,
           -4.7408e-01, -4.8038e-01],
          [-6.2071e-01, -5.2918e-01, -5.4686e-01,  ..., -5.2546e-01,
           -4.5751e-01, -6.0123e-01]],
         [[-6.4606e-01, -6.6378e-01, -5.7933e-01,  ..., -4.8468e-01,
           -5.9113e-01, -5.8605e-01],
          [-1.3361e+00, -1.4563e+00, -1.4215e+00,  ..., -1.3854e+00,
           -1.3837e+00, -1.4220e+00],
          [-4.1664e-02,  2.9362e-02,  8.1976e-03,  ...,  1.0265e-01,
            8.9117e-02,  4.3991e-02],
          ...,
          [-2.1246e-01,  3.2647e-02, -9.6423e-02,  ..., -7.6339e-02,
            3.6190e-02,  2.0057e-02],
          [ 1.3300e-02,  7.6718e-02,  1.1292e-01,  ...,  7.3525e-02,
            9.0222e-02,  7.3313e-02],
          [ 9.3364e-01,  1.0725e+00,  9.9435e-01,  ...,  1.0636e+00,
            1.1552e+00,  1.0042e+00]],
         ...,
         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]],
         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]],
         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]]],
        [[[ 4.3017e-01,  2.7166e-01,  2.9351e-01,  ...,  2.6974e-01,
            4.2142e-01,  2.2402e-01],
          [ 1.7681e-02, -6.2755e-02, -1.6774e-02,  ...,  9.4790e-02,
            1.0243e-01,  6.5938e-02],
          [-1.9729e-01, -1.2606e-01, -1.4091e-01,  ..., -1.3087e-02,
           -8.1330e-02, -7.6515e-02],
          ...,
          [-8.3201e-01, -6.2323e-01, -7.1469e-01,  ..., -7.4211e-01,
           -6.2549e-01, -6.4289e-01],
          [-2.2019e-01, -1.5581e-01, -1.2074e-01,  ..., -5.2034e-02,
           -1.5416e-01, -9.3794e-02],
          [ 1.1264e-01, -9.3610e-02,  2.6903e-01,  ..., -1.0433e-02,
           -9.1190e-02, -1.8875e-01]],
         [[ 4.0149e-01,  3.3156e-01,  3.9280e-01,  ...,  4.4353e-01,
            4.3281e-01,  3.6280e-01],
          [ 1.8136e-01,  7.5841e-02,  1.1480e-01,  ...,  1.7614e-01,
            2.0028e-01,  1.6872e-01],
          [-5.1714e-01, -4.4536e-01, -4.4266e-01,  ..., -3.4318e-01,
           -3.8727e-01, -4.0451e-01],
          ...,
          [-2.1081e-01, -1.0392e-01, -8.9879e-02,  ..., -1.0704e-01,
           -2.4821e-01, -1.8564e-01],
          [ 5.7881e-01,  5.8232e-01,  6.8865e-01,  ...,  5.6765e-01,
            5.7693e-01,  5.6484e-01],
          [-2.5858e-01, -1.4122e-01, -1.9189e-01,  ..., -1.4439e-01,
           -6.3531e-02, -2.1125e-01]],
         [[ 2.8121e-01,  2.7766e-01,  3.6841e-01,  ...,  4.7498e-01,
            3.4255e-01,  3.6801e-01],
          [ 1.5777e-01,  3.3462e-02,  6.7150e-02,  ...,  1.0323e-01,
            4.8880e-02, -6.1280e-03],
          [-1.7341e-01, -1.0428e-01, -1.8503e-01,  ..., -2.0482e-02,
           -7.7965e-02, -8.2971e-02],
          ...,
          [-9.6093e-01, -6.4581e-01, -8.4738e-01,  ..., -8.3241e-01,
           -5.4635e-01, -6.1632e-01],
          [-2.7231e-01, -1.6792e-01, -1.7969e-01,  ..., -1.1907e-01,
           -1.4652e-01, -1.3472e-01],
          [ 1.1939e-01,  1.3005e-01,  2.1566e-01,  ...,  1.5535e-01,
            1.8292e-01,  5.1737e-02]],
         ...,
         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]],
         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]],
         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]]],
        [[[ 3.6779e-01,  2.7417e-01,  3.2488e-01,  ...,  3.5569e-01,
            3.8839e-01,  2.8432e-01],
          [ 7.6347e-02, -2.2462e-02,  1.8371e-02,  ...,  1.1127e-01,
           -2.1172e-03, -7.4759e-02],
          [-1.5067e-01, -8.3533e-02, -2.2705e-01,  ..., -1.4785e-01,
           -1.9997e-02, -1.9419e-01],
          ...,
          [-7.0425e-01, -6.0085e-01, -5.8320e-01,  ..., -7.8051e-01,
           -5.9183e-01, -6.3159e-01],
          [-2.4236e-01, -1.6096e-01, -1.4581e-01,  ..., -1.4379e-01,
           -1.4371e-01, -1.4981e-01],
          [ 1.2188e-01,  2.1254e-01,  1.9598e-01,  ...,  2.1649e-01,
            2.8401e-01,  1.4043e-01]],
         [[-5.9260e-01, -6.6593e-01, -6.0621e-01,  ..., -5.5834e-01,
           -5.6282e-01, -6.3772e-01],
          [-1.3863e+00, -1.4909e+00, -1.4517e+00,  ..., -1.3805e+00,
           -1.4147e+00, -1.4637e+00],
          [-2.7836e-02,  4.1978e-02, -1.7355e-02,  ...,  1.0305e-02,
            1.3115e-01, -3.6645e-02],
          ...,
          [-7.1377e-02,  5.7355e-02,  4.8777e-02,  ...,  1.0089e-01,
           -1.1911e-01, -3.2085e-02],
          [ 1.1560e-01,  1.0049e-01,  2.2862e-01,  ...,  6.3027e-02,
            9.1417e-02,  6.6903e-02],
          [ 9.3469e-01,  1.1076e+00,  9.8600e-01,  ...,  1.0896e+00,
            1.1982e+00,  1.0418e+00]],
         [[ 3.9437e-01,  2.7310e-01,  3.1151e-01,  ...,  3.1907e-01,
            4.0247e-01,  2.5863e-01],
          [ 5.1353e-02, -3.9628e-02,  3.3979e-03,  ...,  1.0633e-01,
            2.9228e-02, -3.2576e-02],
          [-1.6465e-01, -9.6283e-02, -2.0122e-01,  ..., -1.1358e-01,
           -3.5595e-02, -1.6426e-01],
          ...,
          [-6.0608e-01, -5.8366e-01, -4.8216e-01,  ..., -7.2845e-01,
           -6.3745e-01, -6.4691e-01],
          [-2.1231e-01, -1.5398e-01, -1.1182e-01,  ..., -1.3633e-01,
           -1.4456e-01, -1.4526e-01],
          [ 1.2113e-01,  1.8764e-01,  2.0192e-01,  ...,  1.9803e-01,
            2.5349e-01,  1.1365e-01]],
         ...,
         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]],
         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]],
         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]]],
        ...,
        [[[-4.8073e-01, -6.7044e-01, -6.6246e-01,  ..., -7.1247e-01,
           -5.0359e-01, -7.4586e-01],
          [-1.4915e+00, -1.5631e+00, -1.5147e+00,  ..., -1.3847e+00,
           -1.3885e+00, -1.4285e+00],
          [-3.9516e-02,  3.1322e-02,  4.2279e-03,  ..., -3.2576e-02,
            1.5066e-01, -7.4088e-02],
          ...,
          [-2.0738e-01,  3.3536e-02, -9.1194e-02,  ...,  9.4336e-02,
           -1.1337e-01, -3.0157e-02],
          [ 1.1181e-01,  9.9609e-02,  2.2434e-01,  ...,  9.3201e-02,
            8.7982e-02,  8.5325e-02],
          [ 9.3165e-01,  1.0069e+00,  1.0100e+00,  ...,  1.0150e+00,
            1.0748e+00,  9.3360e-01]],
         [[ 3.6145e-01,  2.7443e-01,  3.2806e-01,  ...,  3.6442e-01,
            3.8504e-01,  2.9045e-01],
          [ 8.2306e-02, -1.8369e-02,  2.1941e-02,  ...,  8.7762e-02,
            1.4701e-01,  1.2594e-01],
          [-2.1717e-01, -1.4420e-01, -1.0418e-01,  ..., -7.1817e-02,
           -5.4601e-02, -1.2780e-01],
          ...,
          [-7.2577e-01, -6.0462e-01, -6.0535e-01,  ..., -5.9715e-01,
           -7.5251e-01, -6.8554e-01],
          [-1.3652e-01, -1.3637e-01, -2.6109e-02,  ..., -1.4281e-01,
           -1.4382e-01, -1.4922e-01],
          [ 1.2178e-01,  2.0926e-01,  1.9676e-01,  ...,  2.1406e-01,
            2.8000e-01,  1.3691e-01]],
         [[ 4.9229e-01,  3.2790e-01,  3.4714e-01,  ...,  3.1843e-01,
            4.8088e-01,  2.7503e-01],
          [ 9.5963e-02,  1.7191e-02,  6.3638e-02,  ...,  1.8380e-01,
            1.5167e-01,  1.0329e-01],
          [-4.9546e-01, -4.2558e-01, -4.8272e-01,  ..., -5.4636e-01,
           -2.9480e-01, -5.8192e-01],
          ...,
          [-2.5680e-01, -1.1198e-01, -1.3722e-01,  ..., -1.4249e-01,
           -2.1715e-01, -1.7521e-01],
          [ 5.5835e-01,  5.7756e-01,  6.6551e-01,  ...,  5.8452e-01,
            5.7501e-01,  5.7514e-01],
          [-2.6028e-01, -1.9750e-01, -1.7846e-01,  ..., -1.8611e-01,
           -1.3251e-01, -2.7177e-01]],
         ...,
         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]],
         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]],
         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]]],
        [[[ 2.1976e-01,  2.8014e-01,  3.9931e-01,  ...,  5.5965e-01,
            3.1001e-01,  4.2742e-01],
          [ 2.1556e-01,  7.3156e-02,  1.0177e-01,  ...,  9.5749e-02,
            9.6340e-02,  5.7741e-02],
          [-1.9457e-01, -1.2358e-01, -1.4593e-01,  ..., -5.9491e-02,
           -6.0211e-02, -1.1703e-01],
          ...,
          [-7.8204e-01, -6.1448e-01, -6.6326e-01,  ..., -8.3957e-01,
           -5.4008e-01, -6.1421e-01],
          [-2.7645e-01, -1.6888e-01, -1.8436e-01,  ..., -1.3370e-01,
           -1.4486e-01, -1.4365e-01],
          [ 1.2087e-01,  1.7887e-01,  2.0401e-01,  ...,  1.9153e-01,
            2.4275e-01,  1.0422e-01]],
         [[ 3.8391e-01,  2.7352e-01,  3.1677e-01,  ...,  3.3348e-01,
            3.9693e-01,  2.6874e-01],
          [ 6.1190e-02, -3.2872e-02,  9.2907e-03,  ...,  1.0366e-01,
            4.6122e-02, -9.8396e-03],
          [-1.7218e-01, -1.0316e-01, -1.8730e-01,  ..., -2.9613e-01,
            4.7491e-02, -3.2367e-01],
          ...,
          [-6.6896e-01, -5.9467e-01, -5.4688e-01,  ..., -6.5906e-01,
           -6.9826e-01, -6.6732e-01],
          [-1.7226e-01, -1.4467e-01, -6.6523e-02,  ..., -1.7109e-01,
           -1.4060e-01, -1.6648e-01],
          [ 1.2463e-01,  3.0360e-01,  1.7425e-01,  ...,  2.8398e-01,
            3.9561e-01,  2.3833e-01]],
         [[ 3.2202e-01,  2.7602e-01,  3.4789e-01,  ...,  4.1876e-01,
            3.6416e-01,  3.2857e-01],
          [ 1.1939e-01,  7.1035e-03,  4.4159e-02,  ...,  9.6571e-02,
            9.1130e-02,  5.0730e-02],
          [-1.9225e-01, -1.2146e-01, -1.5022e-01,  ..., -1.8085e-01,
           -4.9791e-03, -2.2300e-01],
          ...,
          [-8.2293e-01, -6.2164e-01, -7.0535e-01,  ..., -7.8035e-01,
           -5.9197e-01, -6.3164e-01],
          [-2.4227e-01, -1.6094e-01, -1.4570e-01,  ..., -1.3163e-01,
           -1.4509e-01, -1.4239e-01],
          [ 1.2066e-01,  1.7196e-01,  2.0566e-01,  ...,  1.8641e-01,
            2.3428e-01,  9.6794e-02]],
         ...,
         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]],
         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]],
         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]]],
        [[[ 3.3640e-01,  2.7544e-01,  3.4066e-01,  ...,  3.9894e-01,
            3.7177e-01,  3.1467e-01],
          [ 1.0587e-01, -2.1839e-03,  3.6058e-02,  ...,  8.6076e-02,
            1.5771e-01,  1.4033e-01],
          [-2.2193e-01, -1.4855e-01, -9.5366e-02,  ..., -4.6867e-02,
           -6.5957e-02, -1.0601e-01],
          ...,
          [-6.0231e-01, -5.8300e-01, -4.7828e-01,  ..., -6.9502e-01,
           -6.6675e-01, -6.5674e-01],
          [-1.9301e-01, -1.4949e-01, -8.9997e-02,  ..., -1.2476e-01,
           -1.4588e-01, -1.3819e-01],
          [ 1.1996e-01,  1.4902e-01,  2.1113e-01,  ...,  1.6941e-01,
            2.0617e-01,  7.2137e-02]],
         [[-5.4864e-01, -6.6770e-01, -6.2831e-01,  ..., -6.1891e-01,
           -5.3954e-01, -6.8022e-01],
          [-1.4277e+00, -1.5193e+00, -1.4764e+00,  ..., -1.3878e+00,
           -1.3685e+00, -1.4015e+00],
          [-4.8450e-02,  2.3171e-02,  2.0737e-02,  ...,  1.9738e-01,
            4.6003e-02,  1.2671e-01],
          ...,
          [-1.2567e-01,  4.7847e-02, -7.0977e-03,  ..., -6.7399e-03,
           -2.4798e-02, -4.1934e-04],
          [ 5.3472e-02,  8.6053e-02,  1.5835e-01,  ...,  6.3983e-02,
            9.1308e-02,  6.7487e-02],
          [ 9.3460e-01,  1.1044e+00,  9.8676e-01,  ...,  1.0872e+00,
            1.1943e+00,  1.0384e+00]],
         [[ 4.1794e-01,  2.7215e-01,  2.9966e-01,  ...,  2.8659e-01,
            4.1495e-01,  2.3584e-01],
          [ 2.9179e-02, -5.4858e-02, -9.8862e-03,  ...,  9.6993e-02,
            8.8447e-02,  4.7120e-02],
          [-1.9105e-01, -1.2037e-01, -1.5243e-01,  ..., -6.3869e-02,
           -5.8219e-02, -1.2086e-01],
          ...,
          [-7.1406e-01, -6.0257e-01, -5.9330e-01,  ..., -5.8120e-01,
           -7.6649e-01, -6.9023e-01],
          [-1.2731e-01, -1.3423e-01, -1.5692e-02,  ..., -1.6356e-01,
           -1.4146e-01, -1.6188e-01],
          [ 1.2387e-01,  2.7850e-01,  1.8024e-01,  ...,  2.6538e-01,
            3.6485e-01,  2.1135e-01]],
         ...,
         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]],
         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]],
         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]]]], device='cuda:0', grad_fn=<CopySlices>)
torch.Size([100, 34, 128, 100])
168  	
169  	        out = self.propagate(edge_index, x=x, edge_attr=edge_attr)
170  	        out = torch.cat([x, out], dim=-2)
171  	        N, D, M = out.shape
172  	        out = self.post_nn(out.view(N*M, -1))
173  	        # return x + out
174  	        return out.view(N, -1, M)
175  	
176  	    def message(self, x_i, x_j, edge_attr):
177  	        if edge_attr is not None:
178  	            #problem before: x_i is 3d, x_j is 2d
NameError: name 'laplacian_batch' is not defined
> /lfs/hyperturing1/0/echoi1/Random-SignNet/GINESignNetPyG/core/model_utils/pyg_gnn_wrapper.py(162)forward()
-> LX = torch.einsum('bij,bjfn->bifn', laplacian_batch, x_padded)
157  	        for i, num_nodes in enumerate(num_nodes_per_graph):
158  	            x_padded[i, :num_nodes] = x[offset:offset + num_nodes]
159  	            offset += num_nodes
160  	        import pdb; pdb.set_trace()
161  	        # Perform batch matrix multiplication for each sample
162  ->	        LX = torch.einsum('bij,bjfn->bifn', laplacian_batch, x_padded)
163  	
164  	        # Flatten back to (num_nodes * batch_size, num_features, num_samples)
165  	        LX = LX.view(-1, LX.size(-2), LX.size(-1))
166  	        import pdb; pdb.set_trace()
167  	
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/lfs/hyperturing1/0/echoi1/Random-SignNet/GINESignNetPyG/train/zinc.py", line 260, in <module>
    run(config_path, cfg, create_dataset, create_model, train, test)
  File "/lfs/hyperturing1/0/echoi1/Random-SignNet/GINESignNetPyG/core/train.py", line 47, in run
    train_loss = train(train_loader, model, optimizer, device=cfg.device, num_samples=cfg.train.num_samples)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lfs/hyperturing1/0/echoi1/Random-SignNet/GINESignNetPyG/train/zinc.py", line 77, in train
    loss = (model(data, rand_x).squeeze() - y).abs().mean()
            ^^^^^^^^^^^^^^^^^^^
  File "/lfs/hyperturing1/0/echoi1/env/micromamba/envs/graphenv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lfs/hyperturing1/0/echoi1/env/micromamba/envs/graphenv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lfs/hyperturing1/0/echoi1/Random-SignNet/GINESignNetPyG/core/sign_net.py", line 149, in forward
    return self.gnn(data, x_rand)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/lfs/hyperturing1/0/echoi1/env/micromamba/envs/graphenv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lfs/hyperturing1/0/echoi1/env/micromamba/envs/graphenv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lfs/hyperturing1/0/echoi1/Random-SignNet/GINESignNetPyG/core/model.py", line 182, in forward
    x = layer(x, data.edge_index, edge_attr, data.laplacian, data.batch)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lfs/hyperturing1/0/echoi1/env/micromamba/envs/graphenv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lfs/hyperturing1/0/echoi1/env/micromamba/envs/graphenv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lfs/hyperturing1/0/echoi1/env/micromamba/envs/graphenv/lib/python3.11/bdb.py", line 96, in trace_dispatch
    return self.dispatch_exception(frame, arg)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lfs/hyperturing1/0/echoi1/env/micromamba/envs/graphenv/lib/python3.11/bdb.py", line 176, in dispatch_exception
    if self.quitting: raise BdbQuit
                      ^^^^^^^^^^^^^
bdb.BdbQuit